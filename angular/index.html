<!DOCTYPE html>
<html>
<head>
  <title>Angular Integration</title>
  <script src="https://unpkg.com/vue/dist/vue.js"></script>
  <script src="node_modules/commons/dist/src/components/index.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.0/angular.min.js"></script>

  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.css">
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="node_modules/commons/dist/src/components/index.css">
</head>
<body>

  <!-- Using hybrid -->

  <div ng-controller="Controller">
    <ng-filter-panel options="options">
    <other-component/>
  </div>

  <script type="text/javascript">

    /** Stub of angular + Vue */

    /** Setup an angular module */
    var module = angular.module('app', []);

    module.controller('Controller', ['$scope', function($scope) {
      $scope.options = ['A'];
      $scope.data = {
        test: 'hi'
      };
    }]);

    /** wrapper around vue component */
    module.directive('ngFilterPanel', function() {
      return {
        restrict: 'E',
        scope: {
          options: '='
        },
        link: function(scope, element) {
          element.prepend('<filter-panel></filter-panel>');

          console.log(scope.options)

          var vm = new Vue({
            el: 'filter-panel',
            components: { FilterPanel: Commons.FilterPanel },
            template: '<filter-panel :options="options" v-on:update="updateAngular"/>',
            data: function () {
              return {
                options: scope.options
              }
            },
            methods: {
              updateAngular: function(value) {
                scope.$apply(function() {
                  scope.options = value;
                });
              }
            }
          });

          element.on('$destroy', function() {
            vm.$destroy();
          });
        }
      }
    });

    /** example consumer module */
    module.directive('otherComponent', function() {
      return {
        restrict: 'E',
        transclude: true,
        templateUrl: 'other-component.html'
      }
    });

    /** bootstap module */
    angular.bootstrap(document.body, ['app']);
  </script>
</body>
</html>